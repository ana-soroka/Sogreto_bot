"""
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ /start –∏ /help
"""
import logging
from telegram import Update
from telegram.ext import ContextTypes
from utils import error_handler, get_or_create_user
from models import SessionLocal

logger = logging.getLogger(__name__)


@error_handler
async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
    user = update.effective_user
    logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.id} ({user.username}) –∑–∞–ø—É—Å—Ç–∏–ª /start")

    # –°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    db = SessionLocal()
    try:
        db_user = get_or_create_user(
            db,
            telegram_id=user.id,
            username=user.username,
            first_name=user.first_name,
            last_name=user.last_name
        )
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ë–î: {db_user}")
    finally:
        db.close()

    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    welcome_message = (
        f"–ü—Ä–∏–≤–µ—Ç, {user.first_name}! üå±\n\n"
        "–Ø ‚Äî —Ç–≤–æ–π –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ –≤ –º–∏—Ä –ø—Ä–∞–∫—Ç–∏–∫ –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏—è.\n\n"
        "–í–º–µ—Å—Ç–µ –º—ã –±—É–¥–µ–º –≤—ã—Ä–∞—â–∏–≤–∞—Ç—å –∫—Ä–µ—Å—Å-—Å–∞–ª–∞—Ç –∏ –∫—É–ª—å—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —ç–º–æ—Ü–∏—é –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏—è. "
        "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –Ω–æ–≤–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞, –Ω–æ–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ.\n\n"
        "**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**\n"
        "/help - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–º–∞–Ω–¥–∞–º\n"
        "/start_practice - –ù–∞—á–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏\n"
        "/pause - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è\n"
        "/resume - –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏\n"
        "/status - –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å\n"
        "/contact - –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π\n\n"
        "–ì–æ—Ç–æ–≤(–∞) –Ω–∞—á–∞—Ç—å? üåø"
    )

    await update.message.reply_text(welcome_message)


@error_handler
async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
    help_text = (
        "**–ö–æ–º–∞–Ω–¥—ã Sogreto Bot** üå±\n\n"
        "**–û—Å–Ω–æ–≤–Ω—ã–µ:**\n"
        "/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/start_practice - –ù–∞—á–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏—è\n"
        "/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É\n\n"
        "**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏:**\n"
        "/pause - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è\n"
        "/resume - –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏\n"
        "/reset - –ù–∞—á–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–Ω–æ–≤–æ\n"
        "/status - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å\n\n"
        "**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**\n"
        "/set_time - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π\n"
        "/timezone - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å\n\n"
        "**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**\n"
        "/examples - –ü—Ä–∏–º–µ—Ä—ã –∂–µ–ª–∞–Ω–∏–π\n"
        "/recipes - –†–µ—Ü–µ–ø—Ç—ã —Å –º–∏–∫—Ä–æ–∑–µ–ª–µ–Ω—å—é\n"
        "/manifesto - –ú–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏—è\n"
        "/contact - –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π\n\n"
        "**–û –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö:**\n"
        "–ü—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è—Ç—Å—è 14-20 –¥–Ω–µ–π –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ 6 —ç—Ç–∞–ø–æ–≤:\n"
        "1Ô∏è‚É£ –ü–æ—Å–∞–¥–∫–∞ (–î–µ–Ω—å 1)\n"
        "2Ô∏è‚É£ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç–∫–æ–≤ (–î–µ–Ω—å 2-3)\n"
        "3Ô∏è‚É£ –ê–∫—Ç–∏–≤–Ω—ã–π —Ä–æ—Å—Ç (–î–µ–Ω—å 4-7)\n"
        "4Ô∏è‚É£ –£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ (–î–µ–Ω—å 8-14)\n"
        "5Ô∏è‚É£ –°–±–æ—Ä —É—Ä–æ–∂–∞—è (–î–µ–Ω—å 14-18)\n"
        "6Ô∏è‚É£ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–î–µ–Ω—å 18-20)\n\n"
        "–í–æ–ø—Ä–æ—Å—ã? –ü–∏—à–∏ /contact üíö"
    )

    await update.message.reply_text(help_text)
